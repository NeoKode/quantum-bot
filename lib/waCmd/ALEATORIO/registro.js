import{createHash as e}from"crypto";import{getDate as t}from"../../calendario.js";import{mapNet as r}from"../../funciones.js";const a=["rgfecha","rgnombre","rgedad","registrado"],n=/([^a-z0-9áéíóúñ :._\-\n]+)/gi;export default{comando:{clave:["rg","reg","unreg","unrg"]},nk:async(o,{conn:{fetchStatus:s,profilePictureUrl:i,sendMessage:g}})=>{const{zZz:{Ureg:c},groupMetadata:{participants:d},codex:l,args:u,chat:p,sender:m,command:h,senderNum:f,reply:b,reacMoji:N}=o,$=global.db.wulid[m]||global.db.wunet[m],{registrado:w}=$||{},{fechaCompleta:x,epoca:y}=t(m),k=r(d);if(["unreg","unrg"].includes(h)){const t=e("md5").update(m).digest("hex");return u[0]?u[0]!==t?b(c()[1]):($.registrado=!1,b(c()[2])):b(c()[0])}if(w)return b(c()[3]);if(!l||!l.includes("-"))return b(c()[4+(l?1:0)]);const[M,j]=[l.split("-")[0].replace(n,""),Math.round(l.split("-").pop())||NaN];if(isNaN(j)||M?.length>=15||j>31||j<12)return b(c()[5+(isNaN(j)?1:M?.length>=15?2:j>31?3:4)]);await N("📝");const z=await s(m).then((e=>e[0]?.status?.status??"~")).catch((e=>"~")),U=j<15?c()[13]:j<18?c()[14]:j<25?c()[15]:c()[16],v=z.length<5?[c()[17],x]:[c()[18],z.length<=27?z:z.substring(0,27)+"..."],C=c(f,M,y-j,U,z,e("md5").update(m).digest("hex"),k[m].split("@")[0])[19],R=await i(m).catch((e=>null)),q=[Date.now(),M,j,!0];for(let e=0;e<a.length;e++)$[a[e]]=q[e];return g(p,{image:{url:`https://nkanvas.onrender.com/crearegistro?apikey=${global.db.nk}&rgtext=${c()[10]}&rgname=${c()[11]+M}&rgage=${c()[12]+j+" | "+U}&rgdatext=${v[0].replace(n,"")+"\n "+v[1].replace(n,"")}&rgdate=${y}&imagen=${encodeURIComponent(R)}`},caption:C,mentions:[m]},{quoted:o})},cmdRdm:0,onlyGp:!0}; /*@NeKosmic*/
